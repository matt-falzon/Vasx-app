"undefined"==typeof RGraph&&(RGraph={}),RGraph.Pie=function(t,e){this.id=t,this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.canvas.__object__=this,this.total=0,this.subTotal=0,this.angles=[],this.data=e,this.properties=[],this.type="pie",this.isRGraph=!0,this.coords=[],this.coords.key=[],this.uid=RGraph.CreateUID(),this.canvas.uid=this.canvas.uid?this.canvas.uid:RGraph.CreateUID(),this.colorsParsed=!1,RGraph.OldBrowserCompat(this.context),this.properties={"chart.colors":["Gradient(red:#fcc)","Gradient(#ddd:#eee)","Gradient(#0f0:#cfc)","Gradient(blue:#ccf)","Gradient(#FB7BA3:#FCC7EE)","Gradient(yellow:#ffc)","Gradient(#000:#ccc)","Gradient(#EE9D80:#FEE5C8)","Gradient(cyan:#ccf)","Gradient(#9E7BF6:#C7B6D2)","Gradient(#78CAEA:#C5FBFD)","Gradient(#E284E9:#FDC4FF)","Gradient(#7F84EF:#FCC4FD)"],"chart.strokestyle":"#999","chart.linewidth":1,"chart.labels":[],"chart.labels.sticks":!1,"chart.labels.sticks.length":7,"chart.labels.sticks.color":"#aaa","chart.gutter.left":25,"chart.gutter.right":25,"chart.gutter.top":25,"chart.gutter.bottom":25,"chart.title":"","chart.title.background":null,"chart.title.hpos":null,"chart.title.vpos":.5,"chart.title.bold":!0,"chart.title.font":null,"chart.title.x":null,"chart.title.y":null,"chart.title.halign":null,"chart.title.valign":null,"chart.shadow":!1,"chart.shadow.color":"rgba(0,0,0,0.5)","chart.shadow.offsetx":3,"chart.shadow.offsety":3,"chart.shadow.blur":3,"chart.text.size":10,"chart.text.color":"black","chart.text.font":"Arial","chart.contextmenu":null,"chart.tooltips":null,"chart.tooltips.event":"onclick","chart.tooltips.effect":"fade","chart.tooltips.css.class":"RGraph_tooltip","chart.tooltips.highlight":!0,"chart.highlight.style":"2d","chart.highlight.style.2d.fill":"rgba(255,255,255,0.7)","chart.highlight.style.2d.stroke":"rgba(255,255,255,0.7)","chart.centerx":null,"chart.centery":null,"chart.radius":null,"chart.border":!1,"chart.border.color":"rgba(255,255,255,0.5)","chart.key":null,"chart.key.background":"white","chart.key.position":"graph","chart.key.halign":"right","chart.key.shadow":!1,"chart.key.shadow.color":"#666","chart.key.shadow.blur":3,"chart.key.shadow.offsetx":2,"chart.key.shadow.offsety":2,"chart.key.position.gutter.boxed":!1,"chart.key.position.x":null,"chart.key.position.y":null,"chart.key.color.shape":"square","chart.key.rounded":!0,"chart.key.linewidth":1,"chart.key.colors":null,"chart.key.interactive":!1,"chart.key.interactive.highlight.chart":"rgba(255,0,0,0.9)","chart.key.interactive.highlight.label":"rgba(255,0,0,0.2)","chart.annotatable":!1,"chart.annotate.color":"black","chart.zoom.factor":1.5,"chart.zoom.fade.in":!0,"chart.zoom.fade.out":!0,"chart.zoom.hdir":"right","chart.zoom.vdir":"down","chart.zoom.frames":25,"chart.zoom.delay":16.666,"chart.zoom.shadow":!0,"chart.zoom.background":!0,"chart.zoom.action":"zoom","chart.resizable":!1,"chart.resize.handle.adjust":[0,0],"chart.resize.handle.background":null,"chart.variant":"pie","chart.variant.donut.width":null,"chart.exploded":[],"chart.effect.roundrobin.multiplier":1,"chart.events.click":null,"chart.events.mousemove":null,"chart.centerpin":null,"chart.centerpin.fill":"white","chart.centerpin.stroke":null,"chart.origin":0-Math.PI/2,"chart.events":!0,"chart.labels.colors":[]};for(var a=0,r=e.length;r>a;a++)this.total+=e[a],this["$"+a]={};this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0);var i=RGraph,s=this.canvas,n=s.getContext("2d"),o=this.properties;this.Set=function(t,e){return t=t.toLowerCase(),"chart."!=t.substr(0,6)&&(t="chart."+t),"chart.highlight.style.2d.color"==t&&(t="chart.highlight.style.2d.fill"),o[t]=e,this},this.Get=function(t){return"chart."!=t.substr(0,6)&&(t="chart."+t),"chart.highlight.style.2d.color"==t&&(t="chart.highlight.style.2d.fill"),o[t]},this.Draw=function(){if(i.FireCustomEvent(this,"onbeforedraw"),this.gutterLeft=o["chart.gutter.left"],this.gutterRight=o["chart.gutter.right"],this.gutterTop=o["chart.gutter.top"],this.gutterBottom=o["chart.gutter.bottom"],this.radius=this.getRadius(),this.centerx=this.graph.width/2+this.gutterLeft,this.centery=this.graph.height/2+this.gutterTop,this.subTotal=this.properties["chart.origin"],this.angles=[],this.coordsText=[],"number"==typeof o["chart.radius"]&&(this.radius=o["chart.radius"]),"number"==typeof o["chart.centerx"]&&(this.centerx=o["chart.centerx"]),"number"==typeof o["chart.centery"]&&(this.centery=o["chart.centery"]),!(0>=this.radius)){if(this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),o["chart.labels.colors"].length<o["chart.labels"].length)for(;o["chart.labels.colors"].length<o["chart.labels"].length;)o["chart.labels.colors"].push(o["chart.labels.colors"][o["chart.labels.colors"].length-1]);else for(o["chart.labels.colors"]===void 0&&(o["chart.labels.colors"]=[]);o["chart.labels.colors"].length<o["chart.labels"].length;)o["chart.labels.colors"].push(o["chart.text.color"]);i.DrawTitle(this,o["chart.title"],s.height/2-this.radius-5,this.centerx,o["chart.title.size"]?o["chart.title.size"]:o["chart.text.size"]+2);this.total=i.array_sum(this.data);for(var t=this.total,e=this.data,a=0,r=this.data.length;r>a;a++){var h=e[a]/t*TWOPI;this.DrawSegment(h,o["chart.colors"][a],a==r-1,a)}i.NoShadow(this),o["chart.linewidth"]>0&&this.DrawBorders();for(var r=this.angles.length,c=this.radius,a=0;r>a;a++){var l=this.angles[a];n.beginPath(),n.strokeStyle="object"==typeof o["chart.strokestyle"]?o["chart.strokestyle"][a]:o["chart.strokestyle"],n.fillStyle=o["chart.colors"][a],n.lineJoin="round",n.arc(l[2],l[3],c,l[0],l[1],!1),"donut"==o["chart.variant"]?n.arc(l[2],l[3],"number"==typeof o["chart.variant.donut.width"]?c-o["chart.variant.donut.width"]:c/2,l[1],l[0],!0):n.lineTo(l[2],l[3]),n.closePath(),n.stroke(),n.fill()}if(o["chart.labels.sticks"]){this.DrawSticks();var d=o["chart.strokestyle"],u="white"==d||"#fff"==d||"#fffffff"==d||"rgb(255,255,255)"==d||"rgba(255,255,255,0)"==d;(!u||u&&this.properties["chart.shadow"])&&this.DrawBorders()}return o["chart.labels"]&&this.DrawLabels(),o["chart.centerpin"]&&this.DrawCenterpin(),o["chart.labels.ingraph"]&&this.DrawInGraphLabels(),o["chart.contextmenu"]&&i.ShowContext(this),o["chart.border"]&&(n.beginPath(),n.lineWidth=5,n.strokeStyle=o["chart.border.color"],n.arc(this.centerx,this.centery,this.radius-2,0,TWOPI,0),n.stroke()),o["chart.key"]&&o["chart.key"].length&&i.DrawKey(this,o["chart.key"],o["chart.colors"]),i.NoShadow(this),o["chart.resizable"]&&i.AllowResizing(this),1==o["chart.events"]&&i.InstallEventListeners(this),i.FireCustomEvent(this,"ondraw"),this}},this.DrawSegment=function(t,e,a,r){ISOLD&&t==TWOPI&&(t-=1e-4);var s=this.subTotal;if(t*=o["chart.effect.roundrobin.multiplier"],n.beginPath(),n.fillStyle=e,n.strokeStyle=o["chart.strokestyle"],n.lineWidth=0,o["chart.shadow"]&&i.SetShadow(this,o["chart.shadow.color"],o["chart.shadow.offsetx"],o["chart.shadow.offsety"],o["chart.shadow.blur"]),"object"==typeof o["chart.exploded"]&&o["chart.exploded"][r]>0||"number"==typeof o["chart.exploded"]){var h="number"==typeof o["chart.exploded"]?o["chart.exploded"]:o["chart.exploded"][r],c=0,l=0,d=s+t/2,c=Math.cos(d)*h,l=Math.sin(d)*h,u=this.radius;n.moveTo(this.centerx+c,this.centery+l)}else var c=0,l=0,u=this.radius;var p=s,f=s+t;n.arc(this.centerx+c,this.centery+l,u,p,f,0),"donut"==o["chart.variant"]?n.arc(this.centerx+c,this.centery+l,"number"==typeof o["chart.variant.donut.width"]?u-o["chart.variant.donut.width"]:u/2,f,p,!0):n.lineTo(this.centerx+c,this.centery+l),n.closePath(),this.angles.push([s,s+t,this.centerx+c,this.centery+l]),n.fill(),this.subTotal+=t},this.DrawLabels=function(){var t="left",e="center",r=o["chart.labels"],s=o["chart.text.font"],h=o["chart.text.size"],c=this.centerx,l=this.centery,d=this.radius;if(i.NoShadow(this),n.fillStyle="black",n.beginPath(),r&&r.length){for(a=0;this.angles.length>a;++a){var u=this.angles[a];if("string"==typeof r[a]||"number"==typeof r[a]){n.moveTo(c,l);var p=u[0]+(u[1]-u[0])/2,f=(u[1]-u[0])/2+u[0];if("object"==typeof o["chart.exploded"]&&o["chart.exploded"][a]||"number"==typeof o["chart.exploded"]){(u[1]-u[0])/2;var g="number"==typeof o["chart.exploded"]?o["chart.exploded"]:o["chart.exploded"][a],m=Math.cos(f)*g,v=Math.sin(f)*g}else var m=0,v=0;o["chart.labels.sticks"]&&(m+=Math.cos(f)*o["chart.labels.sticks.length"],v+=Math.sin(f)*o["chart.labels.sticks.length"]);var y=c+m+(d+10)*Math.cos(p)+(o["chart.labels.sticks"]?HALFPI>p||p>TWOPI+HALFPI?2:-2:0),_=l+v+(d+10)*Math.sin(p);e="center",t=c>y?"right":"left",n.fillStyle=o["chart.text.color"],"object"==typeof o["chart.labels.colors"]&&o["chart.labels.colors"]&&o["chart.labels.colors"][a]&&(n.fillStyle=o["chart.labels.colors"][a]),i.Text2(this,{font:s,size:h,x:y,y:_,text:r[a],valign:e,halign:t,tag:"labels"})}}n.fill()}},this.DrawSticks=function(){for(var t=o["chart.linewidth"]/2,e=o["chart.exploded"],a=o["chart.labels.sticks"],r=this.angles.length,i=this.centerx,s=this.centery,h=this.radius,c=0;r>c;++c){var l=this.angles[c];if("object"!=typeof a||a[c]){var d=l[1]-l[0];n.beginPath(),n.strokeStyle=o["chart.labels.sticks.color"],n.lineWidth=1;var u=l[0]+d/2;if("object"==typeof e&&e[c])var p=e[c];else if("number"==typeof e)var p=e;else var p=0;n.lineWidth=1,n.arc(i,s,h+o["chart.labels.sticks.length"]+p,u,u+.001,0),n.arc(i,s,h+p+t,u,u+.001,0),n.stroke()}}},this.getShape=this.getSegment=function(t){i.FixEventObject(t),arguments[1]?arguments[1]:0;var e=i.getMouseXY(t),a=e[0],r=e[1];this.radius;for(var s=this.angles,h=[],c=0,l=s.length;l>c;++c)if(n.beginPath(),n.strokeStyle="rgba(0,0,0,0)",n.arc(s[c][2],s[c][3],this.radius,s[c][0],s[c][1],!1),"pie"==this.type&&"donut"==o["chart.variant"]?n.arc(s[c][2],s[c][3],"number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]:this.radius/2,s[c][1],s[c][0],!0):n.lineTo(s[c][2],s[c][3]),n.closePath(),n.isPointInPath(a,r)){h[0]=s[c][2],h[1]=s[c][3],h[2]=this.radius,h[3]=s[c][0]-TWOPI,h[4]=s[c][1],h[5]=c,0>h[3]&&(h[3]+=TWOPI),h[4]>TWOPI&&(h[4]-=TWOPI);var d=i.parseTooltipText?i.parseTooltipText(o["chart.tooltips"],h[5]):null;return h.object=this,h.x=h[0],h.y=h[1],h.radius=h[2],h["angle.start"]=h[3],h["angle.end"]=h[4],h.index=h[5],h.tooltip=d,h}return null},this.DrawBorders=function(){if(o["chart.linewidth"]>0){n.lineWidth=o["chart.linewidth"],n.strokeStyle=o["chart.strokestyle"];for(var t=this.radius,e=0,a=this.angles.length;a>e;++e){var r=this.angles[e];n.beginPath(),n.arc(r[2],r[3],t,r[0],r[0]+.001,0),n.arc(r[2],r[3],"donut"==o["chart.variant"]?"number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]:t/2:t,r[0],r[0]+1e-4,0),n.closePath(),n.stroke()}}},this.getRadius=function(){return this.graph={width:s.width-o["chart.gutter.left"]-o["chart.gutter.right"],height:s.height-o["chart.gutter.top"]-o["chart.gutter.bottom"]},this.radius="number"==typeof o["chart.radius"]?o["chart.radius"]:Math.min(this.graph.width,this.graph.height)/2,this.radius},this.Explode=function(t,e){if(o["chart.exploded"]||(o["chart.exploded"]=[]),"number"==typeof o["chart.exploded"]){var a=o["chart.exploded"],r=o["chart.exploded"];o["chart.exploded"]=[];for(var n=0,h=this.data.length;h>n;++n)o["chart.exploded"][n]=r}o["chart.exploded"][t]="number"==typeof a?a:0;for(var c=0;e>c;++c)setTimeout(function(){o["chart.exploded"][t]+=1,i.Clear(s),i.RedrawCanvas(s)},c*(ISIE&&!ISIE10?25:16.666))},this.highlight_segment=function(t){n.beginPath(),n.strokeStyle=o["chart.highlight.style.2d.stroke"],n.fillStyle=o["chart.highlight.style.2d.fill"],n.moveTo(t[0],t[1]),n.arc(t[0],t[1],t[2],this.angles[t[5]][0],this.angles[t[5]][1],0),n.lineTo(t[0],t[1]),n.closePath(),n.stroke(),n.fill()},this.Highlight=function(t){if(o["chart.tooltips.highlight"])if("3d"==o["chart.highlight.style"]){n.lineWidth=1;var e=2;n.beginPath(),i.NoShadow(this),n.fillStyle="rgba(0,0,0,0)",n.arc(t.x,t.y,t.radius,t["angle.start"],t["angle.end"],!1),"donut"==o["chart.variant"]?n.arc(t.x,t.y,t.radius/5,t["angle.end"],t["angle.start"],!0):n.lineTo(t.x,t.y),n.closePath(),n.fill(),n.beginPath(),n.shadowColor="#666",n.shadowBlur=3,n.shadowOffsetX=3,n.shadowOffsetY=3,n.fillStyle=o["chart.colors"][t.index],n.strokeStyle=o["chart.strokestyle"],n.arc(t.x-e,t.y-e,t.radius,t["angle.start"],t["angle.end"],!1),"donut"==o["chart.variant"]?n.arc(t.x-e,t.y-e,t.radius/2,t["angle.end"],t["angle.start"],!0):n.lineTo(t.x-e,t.y-e),n.closePath(),n.stroke(),n.fill(),i.NoShadow(this),o["chart.border"]&&(n.beginPath(),n.strokeStyle=o["chart.border.color"],n.lineWidth=5,n.arc(t.x-e,t.y-e,t.radius-2,t["angle.start"],t["angle.end"],!1),n.stroke())}else n.beginPath(),n.strokeStyle=o["chart.highlight.style.2d.stroke"],n.fillStyle=o["chart.highlight.style.2d.fill"],"donut"==o["chart.variant"]?(n.arc(t.x,t.y,t.radius,t["angle.start"],t["angle.end"],!1),n.arc(t.x,t.y,"number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]:t.radius/2,t["angle.end"],t["angle.start"],!0)):(n.arc(t.x,t.y,t.radius+1,t["angle.start"],t["angle.end"],!1),n.lineTo(t.x,t.y)),n.closePath(),n.fill()},this.getObjectByXY=function(t){return this.getShape(t)?this:void 0},this.DrawCenterpin=function(){if("number"==typeof o["chart.centerpin"]&&o["chart.centerpin"]>0){var t=this.centerx,e=this.centery;n.beginPath(),n.strokeStyle=o["chart.centerpin.stroke"]?o["chart.centerpin.stroke"]:o["chart.strokestyle"],n.fillStyle=o["chart.centerpin.fill"]?o["chart.centerpin.fill"]:o["chart.strokestyle"],n.moveTo(t,e),n.arc(t,e,o["chart.centerpin"],0,TWOPI,!1),n.stroke(),n.fill()}},this.positionTooltip=function(t,e,a,r,i){t.angles[i][2],t.angles[i][3];var s=t.angles[i][0],n=t.angles[i][1],h=(n-s)/2+s,c=RGraph.getCanvasXY(t.canvas);o["chart.gutter.left"],o["chart.gutter.top"];var l=r.offsetWidth,d=r.offsetHeight,e=c[0]+this.angles[i][2]+Math.cos(h)*("donut"==o["chart.variant"]&&"number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]+o["chart.variant.donut.width"]/2:this.radius*("donut"==o["chart.variant"]?.75:.5)),a=c[1]+this.angles[i][3]+Math.sin(h)*("donut"==o["chart.variant"]&&"number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]+o["chart.variant.donut.width"]/2:this.radius*("donut"==o["chart.variant"]?.75:.5));r.style.overflow="";var u=new Image;u.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAFCAYAAACjKgd3AAAARUlEQVQYV2NkQAN79+797+RkhC4M5+/bd47B2dmZEVkBCgcmgcsgbAaA9GA1BCSBbhAuA/AagmwQPgMIGgIzCD0M0AMMAEFVIAa6UQgcAAAAAElFTkSuQmCC",u.style.position="absolute",u.id="__rgraph_tooltip_pointer__",u.style.top=r.offsetHeight-2+"px",r.appendChild(u),10>e-l/2?(r.style.left=e-.1*l+"px",r.style.top=a-d-4+"px",u.style.left=.1*l-8.5+"px"):e+l/2>document.body.offsetWidth-10?(r.style.left=e-.9*l+"px",r.style.top=a-d-4+"px",u.style.left=.9*l-8.5+"px"):(r.style.left=e-l/2+"px",r.style.top=a-d-4+"px",u.style.left=.5*l-8.5+"px")},this.DrawInGraphLabels=function(){if(this.centerx,this.centery,"donut"==o["chart.variant"]){var t=.75*this.radius;if("number"==typeof o["chart.variant.donut.width"])var t=this.radius-o["chart.variant.donut.width"]+o["chart.variant.donut.width"]/2}else var t=this.radius/2;for(var e=0,a=this.angles.length;a>e;++e){if("object"==typeof o["chart.exploded"]&&"number"==typeof o["chart.exploded"][e])var r=o["chart.exploded"][e];else if("number"==typeof o["chart.exploded"])var r=parseInt(o["chart.exploded"]);else var r=0;var s=this.angles[e][0],h=this.angles[e][1],c=(h-s)/2+s,l=i.getRadiusEndPoint(this.centerx,this.centery,c,t+(r?r:0)),d=l[0],u=l[1],p=o["chart.labels.ingraph.specific"]&&"string"==typeof o["chart.labels.ingraph.specific"][e]?o["chart.labels.ingraph.specific"][e]:i.number_format(this,this.data[e],o["chart.labels.ingraph.units.pre"],o["chart.labels.ingraph.units.post"]);if(p){n.beginPath();var f="string"==typeof o["chart.labels.ingraph.font"]?o["chart.labels.ingraph.font"]:o["chart.text.font"],g="number"==typeof o["chart.labels.ingraph.size"]?o["chart.labels.ingraph.size"]:o["chart.text.size"]+2;i.Text2(this,{font:f,size:g,x:d,y:u,text:p,valign:"center",halign:"center",bounding:!0,boundingFill:"white",tag:"labels.ingraph"}),n.stroke()}}},this.getAngle=function(t){if(t>this.total)return null;var e=t/this.total*TWOPI;return e+=o["chart.origin"]},this.parseColors=function(){for(var t=0;o["chart.colors"].length>t;++t)o["chart.colors"][t]=this.parseSingleColorForGradient(o["chart.colors"][t]);var e=o["chart.key.colors"];if(e)for(var t=0;e.length>t;++t)e[t]=this.parseSingleColorForGradient(e[t]);o["chart.chart.strokestyle"]=this.parseSingleColorForGradient(o["chart.strokestyle"]),o["chart.highlight.stroke"]=this.parseSingleColorForGradient(o["chart.highlight.stroke"]),o["chart.highlight.style.2d.fill"]=this.parseSingleColorForGradient(o["chart.highlight.style.2d.fill"]),o["chart.highlight.style.2d.stroke"]=this.parseSingleColorForGradient(o["chart.highlight.style.2d.stroke"])},this.parseSingleColorForGradient=function(t){if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){var e=RegExp.$1.split(":");if("donut"==o["chart.variant"])var a="number"==typeof o["chart.variant.donut.width"]?this.radius-o["chart.variant.donut.width"]:this.radius/2;else var a=0;var r=n.createRadialGradient(this.centerx,this.centery,a,this.centerx,this.centery,Math.min(s.width-o["chart.gutter.left"]-o["chart.gutter.right"],s.height-o["chart.gutter.top"]-o["chart.gutter.bottom"])/2),h=1/(e.length-1);r.addColorStop(0,i.trim(e[0]));for(var c=1;e.length>c;++c)r.addColorStop(c*h,i.trim(e[c]))}return r?r:t},this.interactiveKeyHighlight=function(t){if(this.angles&&this.angles[t]){var e=this.angles[t],a=e[2],r=e[3],i=e[0],s=e[1];n.strokeStyle="black",n.fillStyle=o["chart.key.interactive.highlight.chart"],n.lineWidth=2,n.lineJoin="bevel",n.beginPath(),n.moveTo(a,r),n.arc(a,r,this.radius,i,s,!1),n.closePath(),n.fill(),n.stroke()}},RGraph.Register(this)};