function setLastPaymentTable(){lastPaymentLabel.setText(lastPaymentText);var e=Ti.UI.createTableViewRow({selectedBackgroundColor:"transparent",title:amountText,height:40});amountLabel.setText("$67.65"),e.add(amountLabel),tableData.push(e);var e=Ti.UI.createTableViewRow({selectedBackgroundColor:"transparent",title:dateText,height:40,width:"70%"});dateLabel.setText("15/6/13"),e.add(dateLabel),tableData.push(e),table.setData(tableData),tableData=[]}function setCurrentBalanceTable(){currentBalanceLabel.setText(currentBalanceText);var e=Ti.UI.createTableViewRow({selectedBackgroundColor:"transparent",title:totalDueText,height:40});balanceLabel.setText("..."),getBalance(win.id,"en",1),e.add(balanceLabel),tableData.push(e);var e=Ti.UI.createTableViewRow({selectedBackgroundColor:"transparent",title:paymentDueDateText,height:40});CurrentBalanceDateLabel.setText("17/8/13"),e.add(CurrentBalanceDateLabel),tableData.push(e),totalTable.setData(tableData),tableData=[]}function setBottomTable(){var e=[{hasDetail:!0,title:viewAsPdfText,url:"pdfPrint.js"},{hasDetail:!0,title:viewAllDocumentsText,url:"allDocuments.js"}];bottomTable.setData(e)}function appLanguage(){"pt"==Ti.App.Language?(amountText="quantidade",dateText="data",lastPaymentText="último pagamento",currentBalanceText="saldo atual",totalDueText="total devido",paymentDueDateText="data de vencimento",viewAsPdfText="ver em pdf",viewAllDocumentsText="ver todos os documentos"):"fr"==Ti.App.Language?(amountText="chamadas: ",dateText="dados: ",lastPaymentText="tempo de sobra: ",currentBalanceText="solde courant",totalDueText="total dû",paymentDueDateText="paiement date d'échéance",viewAsPdfText="Afficher au format PDF",viewAllDocumentsText="Voir tous les documents"):(amountText="Amount",dateText="Date",lastPaymentText="Last Payment",currentBalanceText="Current Balance",totalDueText="Total Due",paymentDueDateText="Payment Due Date",viewAsPdfText="View as PDF",viewAllDocumentsText="View All Documents")}function getBalance(e,t,a){var r=Ti.Network.createHTTPClient();r.onerror=function(){Ti.API.error(this.status+" - "+this.statusText)};var i=[{SessionID:e,LanguageCode:t,VirtualNetwork:a}],n=generateXML("http://service.adminportal.vasx.com/","getAgingData",i);r.open("POST","http://192.168.20.3:12080/vx_adminportal/AdminPortal"),r.setRequestHeader("Content-Type","text/xml"),r.setRequestHeader("Content-Length",n.length),r.setRequestHeader("SOAPAction",'"getAgingData"'),r.send(n),r.onload=function(){var e=r.responseXML.documentElement.getElementsByTagName("getAgingDataResponse");if(Ti.API.info(e.item(0).text),e&&e.length>0){var t=Ti.XML.parseString(e.item(0).text);t.getElementsByTagName("Message");var a=t.getElementsByTagName("CurrentBalance");balanceLabel.setText("$"+a.item(0).text)}}}var win=Ti.UI.currentWindow;Ti.include(Ti.Filesystem.resourcesDirectory+"/libs/webService.js"),Ti.include(Ti.Filesystem.resourcesDirectory+"/libs/commonFunctions.js");var myId=win.id;win.backgroundColor="#1BA5E0";var myTabGroup=Ti.UI.currentWindow.tabGroup;appLanguage(),theme("green");var tableInfo=[{title:"Amount"},{title:"Date"}],tableData=[],mainView=Ti.UI.createView({backgroundColor:Ti.App.backgroundColor}),logout=Ti.UI.createButton({title:"Log out",style:Ti.UI.iPhone.SystemButtonStyle.BORDERED}),lastPaymentLabel=Ti.UI.createLabel({text:lastPaymentText,top:"15%"}),amountLabel=Ti.UI.createLabel({font:{fontSize:22,fontWeight:"bold"},right:15,color:Ti.App.backgroundColor}),dateLabel=Ti.UI.createLabel({font:{fontSize:24,fontWeight:"bold"},right:15,color:Ti.App.backgroundColor}),table=Ti.UI.createTableView({data:tableData,backgroundColor:"transparent",scrollable:!1,allowsSelection:!1,separatorColor:Ti.App.foregroundColor}),balanceLabel=Ti.UI.createLabel({font:{fontSize:24,fontWeight:"bold"},right:15,color:Ti.App.backgroundColor}),currentBalanceLabel=Ti.UI.createLabel({text:currentBalanceText,top:"15%"}),CurrentBalanceDateLabel=Ti.UI.createLabel({text:"...",font:{fontSize:24,fontWeight:"bold"},right:15,color:Ti.App.backgroundColor}),totalTable=Ti.UI.createTableView({data:tableData,backgroundColor:"transparent",scrollable:!1,allowsSelection:!1,separatorColor:Ti.App.foregroundColor}),bottomTable=Ti.UI.createTableView({backgroundColor:"transparent",scrollable:!1,allowsSelection:!0,separatorColor:Ti.App.foregroundColor});bottomTable.addEventListener("click",function(e){if(e.rowData.url)var t=Ti.UI.createWindow({backgroundColor:"#fff",title:e.rowData.title,url:e.rowData.url,id:win.id});Ti.UI.currentTab.open(t)}),win.addEventListener("focus",function(){appLanguage(),setBottomTable(),setCurrentBalanceTable(),setLastPaymentTable()}),logout.addEventListener("click",function(){endSession()});var theView=Ti.UI.createView({backgroundColor:Ti.App.foregroundColor,height:80,left:10,right:10,borderRadius:10,top:50}),titleView=Ti.UI.createView({backgroundColor:Ti.App.foregroundColor,height:50,left:10,right:10,top:10}),titleView2=Ti.UI.createView({backgroundColor:Ti.App.foregroundColor,height:50,left:10,right:10,top:140}),bottomMenuView=Ti.UI.createView({backgroundColor:Ti.App.foregroundColor,height:89,left:10,right:10,top:270}),totalBalanceView=Ti.UI.createView({backgroundColor:Ti.App.foregroundColor,height:80,left:10,right:10,borderRadius:10,top:180}),seperatorView=Ti.UI.createView({backgroundColor:Ti.App.backgroundColor,height:"4%",width:"100%",bottom:"20%"}),seperatorView2=Ti.UI.createView({backgroundColor:Ti.App.backgroundColor,height:"4%",width:"100%",bottom:"20%"});mainView.add(bottomMenuView),bottomMenuView.add(bottomTable),totalBalanceView.add(totalTable),mainView.add(totalBalanceView),mainView.add(titleView2),titleView.add(seperatorView),titleView2.add(seperatorView2),mainView.add(titleView),titleView.add(lastPaymentLabel),titleView2.add(currentBalanceLabel),theView.add(table),mainView.add(theView),win.setLeftNavButton(logout),win.add(mainView);