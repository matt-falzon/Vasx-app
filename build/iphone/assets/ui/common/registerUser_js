function registerUser(e,t){var a=Ti.UI.create2DMatrix();a=a.scale(0),Ti.App.msisdn=t,Ti.App.network="";var r=Ti.UI.createWindow({backgroundColor:"#336699",borderWidth:8,borderColor:"#999",height:"89%",width:"93%",borderRadius:10,opacity:.93,transform:a}),i=Ti.UI.createLabel({text:"Swipe down when done",visible:!1,color:"white"}),n=Ti.UI.create2DMatrix();n=n.scale(1.1);var o=Ti.UI.createAnimation();o.transform=n,o.duration=200,o.addEventListener("complete",function(){Ti.API.info("Register Window");var e=Ti.UI.create2DMatrix();e=e.scale(1),r.animate({transform:e,duration:200})});var s=Ti.UI.createButton({title:"Register",height:"7%",width:"50%",bottom:"8%"});r.add(s);var l=Ti.UI.createTextField({height:"7%",bottom:"30%",color:"black",hintText:"Network: ",left:"10%",right:"10%",font:{fontSize:"19pt",fontWeight:"bold"},textAlign:"TEXT_ALIGNMENT_CENTER",backgroundColor:"#E3E8E8",editable:!1});r.add(l),s.addEventListener("click",function(){if(Ti.App.msisdn=t,(""==Ti.App.network||""==Ti.App.msisdn)&&(0==Ti.App.network.length&&""==Ti.App.msisdn?alert("No phone number or network selected"):0==Ti.App.network.length?alert("No network selected"):""==Ti.App.msisdn&&alert("No phone number entered")),Ti.App.network.length>0&&Ti.App.msisdn.length>0&&Ti.App.country.length>0&&Ti.App.url.length>0){var a=Ti.Database.open("local"),i=a.execute("SELECT msisdn FROM data WHERE msisdn ="+Ti.App.msisdn);for(0==i.isValidRow()?(i=a.execute("INSERT INTO data (msisdn, url, country, site_name) VALUES (?, ?, ?, ?)",Ti.App.msisdn,Ti.App.url,Ti.App.country,Ti.App.network),a.execute("INSERT INTO user_language (msisdn, lang_code, lang_name) VALUES(?,?,?)",Ti.App.msisdn,"en","English")):(i=a.execute("UPDATE data SET url = ?, country = ?, site_name = ? WHERE msisdn = ?",Ti.App.url,Ti.App.country,Ti.App.network,Ti.App.msisdn),a.execute("UPDATE user_language SET lang_code = ?, lang_name = ? WHERE msisdn = ?",e[0].language[0].code,e[0].language[0].name,Ti.App.msisdn)),i=a.execute("SELECT * FROM data"),Ti.API.info("Database");i.isValidRow();){var n=i.fieldByName("msisdn"),o=i.fieldByName("site_name");Ti.API.info("Number: "+n+" Site Name: "+o),i.next()}a.close()}var s=Ti.UI.create2DMatrix();s=s.scale(0),r.close({transform:s,duration:300})});for(var c=Ti.UI.createView({backgroundColor:"transparent",left:"3%",right:"3%",borderRadius:10,top:"3%",bottom:"40%",borderColor:"white",borderSize:2}),d=[],u=0;e.length>u;u++){var h=Ti.UI.createTableViewRow({selectedBackgroundColor:"transparent",height:40,country:e[u].country,network:e[u].network,url:e[u].url,language:e[u].language,vnUID:e[u].vnUID});textLabel=Ti.UI.createLabel({text:e[u].country+" - "+e[u].network,color:"white",font:{fontSize:"16pt",fontWeight:"bold"},left:0}),h.add(textLabel);var p,g=Ti.Filesystem.applicationDataDirectory;p=Ti.Filesystem.getFile(g,e[u].country+"Flag.png")?"/images/flags/"+e[u].country+"Flag.png":"/images/flags/saFlag.png";var m=Ti.UI.createImageView({image:p,right:"1.5%",height:"70%",width:"17%"});h.add(m),d.push(h)}var f=Ti.UI.createTableView({data:d,backgroundColor:"transparent",allowSelection:!0});f.addEventListener("click",function(e){l.setValue(e.rowData.network+", "+e.rowData.country),l.blur(),Ti.App.network=e.rowData.network,Ti.App.url=e.rowData.url,Ti.App.country=e.rowData.country;for(var t=0;e.rowData.language.length>t;t++)Ti.Locale.getCurrentLanguage()==e.rowData.language[t].code&&(Ti.App.language=e.rowData.language[t].code);""==Ti.App.Language&&(Ti.App.language=e.rowData.language[0].code),Ti.API.info("Country: "+e.rowData.country),Ti.API.info("Site Name: "+e.rowData.network),Ti.API.info("Site URL: "+e.rowData.url),Ti.API.info("vnUID: "+e.rowData.vnUID),Ti.API.info("Phones Language: "+Ti.Locale.getCurrentLanguage());for(var a=0;e.rowData.language.length>a;a++)Ti.API.info("Language Available: "+e.rowData.language[a].name);Ti.API.info("Default Language: "+e.rowData.language[0].name)}),l.addEventListener("focus",function(){this.setBottom("80%"),f.hide()}),l.addEventListener("blur",function(){this.setBottom("30%"),f.show()}),c.add(f),r.add(c),c.add(i),r.addEventListener("swipe",function(e){"down"==e.direction&&(msisdnTextField.blur(),l.blur())}),r.open(o)}exports.registerUser=registerUser;